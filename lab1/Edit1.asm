/**********************************************/
/*               Work with cycle              */
/**********************************************/

#include "def21060.h"
#define N 4000

//---------------------------------------------
// Source array
// 0x30000
.SECTION/DM		dm_data;
.VAR input[N];
//---------------------------------------------

//---------------------------------------------
// Result array
// 0x24000
.SECTION/PM		pm_data;
.VAR output[N];
//---------------------------------------------

//---------------------------------------------
// 0x20004 - 0x20007
.SECTION/PM		pm_iqr_svc;
		nop;
		jump start;
		nop;
		nop;
//---------------------------------------------

//---------------------------------------------
// 0x20100 - 0x20200
.SECTION/PM		pm_code;
start:
		I0 = input;
		I1 = input;
		M0 = 1;
		M1 = 125;
		I8 = output;
		I9 = output;
		M8 = 1;
		M9 = 125;
	
		LCNTR = 115, DO xxx UNTIL LCE;
			I0 = I1;
			I8 = I9;
			LCNTR = 125, DO yyy UNTIL LCE;
				R1 = DM(I0, M0);
yyy:			PM(I8, M8) = R1;
			MODIFY(I1, M1);
xxx:		MODIFY(I9, M9);

wait:	IDLE;
		jump wait; 
//---------------------------------------------
